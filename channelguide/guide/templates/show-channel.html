{% extends 'base.html' %}

{% comment %}
  Copyright (c) 2008 Participatory Culture Foundation
  See LICENSE for details.
{% endcomment %}

{% load cg_helpers channels i18n notes %}

{% block head-extra %}
  <script type="text/javascript" src="{{ STATIC_BASE_URL }}js/playback.js"></script>
  <script type="text/javascript" src="{{ STATIC_BASE_URL }}js/share.js"></script>
  <script type="text/javascript" src="{{ STATIC_BASE_URL }}js/infinitescroll.js"></script>
  <style type="text/css">
    div#page {
        margin-bottom: 0;
    }

    div#content {
        border-bottom: none;
    }
  </style>
{% endblock %}

{% block onload-extra %}add_share_callbacks();{% endblock %}

{% block title %}{% trans "Miro Guide - " %} {{ channel.name|escape }}{% endblock %}

{% block body-attributes %} {% endblock %}

{% block content %}
  {% if error %}
    <div class="error">{{ error }}</div>
  {% endif %}

  {% if show_edit_button %}
    {% include "guide/edit-bar.html" %}
  {% endif %}

  {% if share_links %}
    {% include "guide/share-links.html" %}
  {% else %}
  {% if geoip_restricted %}
<div class="alert">
  <div class="page">
    <div class="alertBox ">
      <h2>
        {% blocktrans %}
        This show may not be available to you, as it is restricted to certain countries.
        {% endblocktrans %}
      </h2>
    </div>
  </div>
</div>
  {% endif %}
  {% endif %}

  <div id="channelInfo">
    <div class="page">
      {% if channel.url %}
        <a href="{{ channel.url }}" class="channel_feed_only">
          <img src="{{ STATIC_BASE_URL }}images/ico_red_feeds.png" alt="RSS">
        </a>
      {% else %}
        <a href="{{ channel.website_url }}" class="stream_only">
          <img src="{{ STATIC_BASE_URL }}images/ico_stream.png" alt="Site">
        </a>
      {% endif %}
      <h1>{{ channel.name }}</h1>
      {% if not channel.fake %}
        <div class="rate">
          {% show_rating_stars channel %}
        </div><!--rate-->
      {% endif %}
    </div>
  </div>

  <div id="channelDetails2">
    <div class="page">
      <div class="channelDetailsContent">
        <a class="large_add_button {% if channel.url %}feed{% else %}site {% endif %}"
           {{ channel.subscription_link }}>
          <span>
            {% if channel.url %}
              {% trans "Add to your feeds" %}
            {% else %}
              {% trans "Add to your sites" %}
            {% endif %}
          </span>
        </a>

        <a class="url" href="{{ channel.website_url }}">
          {% trans "Visit Show Website" %}
          <span>{{ channel.website_url }}</span>
        </a>

	<h4>{% trans "Details" %}</h4>
        {% showall channel.description 45 "description" %}
        {% ifshowall channel.description 45 %}<a href="#" class="read_more" onclick="p=$('#channelDetails2 .channelDetailsContent p.description').toggleClass('on'); return false;">{% trans "Show all" %}</a>{% endifshowall %}

        {% if not channel.fake %}
          <div class="tags">
            <p>
              <strong>{% trans "Categories" %}</strong> -
              {% for category in channel.categories %}
                {{ category.link }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            </p>
            {% if channel.tags %}
              <p>
                <strong>{% trans "Tags" %}</strong> -
                {% for tag in channel.tags %}
                  {{ tag.link }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </p>
            {% endif %}
          </div>
        {% endif %}
      </div>

      <a href="{{ self.get_subscription_url }}">
        <span class="thumb corners"
              style="background: url({{ channel.thumb_url_245_164 }}); width: 245px; height: 164px;">
          {% if channel.hi_def %}
          <img class="hd_tag_large channel2_hd"
               src="{{ STATIC_BASE_URL }}images/ico_hd_tag_large.png" alt="HD">
          {% endif %}
        </span>
        </a>
    </div>
  </div>

  {% comment %}
    <div class="horizontal_banner_ad">
      <a href="#">
        <img src="{{ STATIC_BASE_URL }}images/ads/728x90.jpg" alt="Ad">
      </a>
    </div>
  {% endcomment %}
  {% if channel.url %}
  <div id="channelEpisodes">
    <div class="page">
      <div class="pageContent">
	<div class="detailsHead">
	  <h3 class="resultsCount">
	    <span class="heading">{% trans "Recently Aired" %}</span>
	    <span class="button">
              <a href="#">
                <img src="{{ STATIC_BASE_URL }}images/ico_refresh.png" alt="">
              </a>
            </span>
	  </h3>
	  <div class="sortType">
	    <a href="#">{% trans "All" %}</a>
	  </div>
	</div><!--detailsHead-->

	<ul class="paginator">
          <li class="tag">Pages</li>
          {% for number, link in item_page_links %}
            {% ifequal number "tag" %}
              <li class="tag">...</li>
            {% else %}
              <li {% ifequal number item_page.number %}
                    class="selected"
                  {% endifequal %}>
                <span><a href="{{ link }}">{{ number }}</a></span>
              </li>
            {% endifequal %}
          {% endfor %}
	</ul>

	<br class="clear_all">
        <ul class="scrolling">
          {% for item in item_page.object_list %}
          <li>
            {% if forloop.first %}<a name="{{ item_page.number }}"></a>{% endif %}
            <div class="detailsTop"></div>
            {% include "guide/item.html" %}
          </li>
          {% endfor %}
        </ul>
      </div>
      <script type="text/javascript">
          $("#channelEpisodes div.details").each(setUpItem);
      </script>

      {% if recommendations %}
        <div class="pageSideBar">
          <div id="sideBarSmall">
            <div class="detailsHead2">
              <h3 class="resultsCount">
                <span class="heading">{% trans "Related Videos" %}</span>
              </h3>
              <div class="sortType">
                <a href="#">{% trans "All" %}</a>
              </div>
            </div><!--detailsHead-->
            <div class="widget_small">
              <ul class="related">
                {% for channel in recommendations %}
                  <li>
                    {% include "guide/channel-mini.html" %}
                  </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
  {% endif %}
{% endblock %}
