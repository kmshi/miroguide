{% extends 'base.html' %}
{% load cg_helpers channels i18n notes %}
{% block head-extra %}<script src="{{ STATIC_BASE_URL }}js/jquery.js" type="text/javascript"></script>
<script src="{{ STATIC_BASE_URL }}js/rating.js" type="text/javascript"></script>
<link rel="StyleSheet" type="text/css" href="{{ STATIC_BASE_URL }}css/rating.css">
<script type="text/javascript">
{% if shade_description %}
$(document).ready(function(){
        $('#reveal').show();
    });
{% endif %}
function lowerDescription(){
$("#reveal").hide();
$("#description").animate(
    {'height':$('#description #full').height()}, 'slow');
$("#hide").show();
return false;
};

function raiseDescription(){
$("#hide").hide();
$("#description").height("");
$("#reveal").show();
return false;
};
</script>{% endblock %}
{% block title %}{{ channel.name }} - Miro{%endblock %}
{% block content %}
{% if error %}
<div class="error">{{ error }}</div>
{% endif %}
<div class="channel channel-full">
<h1 class="title">
    {{ channel.name|escape }}
</h1>
    {% twocolumns %}
        <div class="screenshot">
            {{ channel.thumb_370_247 }}
            {% if channel.hi_def %}
                <img class="hd-icon-large" src="{{ STATIC_BASE_URL }}images/hd-icon-large.png" alt="HD">
            {% endif %}
        </div>
        <div class="big horizontal">
            <ul class="actions">
                <li id="subscribe" class="big horizontal">
                    <a {{ channel.subscription_link }}>
                        <span class="icon"></span>
                        {% trans "Add Channel" %}
                    </a>
                </li>
                <li id="rate">
                    {{ ratings_bar }}
                    <div id="average">Avg. of {{ channel.count_rating }} rating{{ channel.count_rating|pluralize }}: <strong>{{ channel.average_rating|floatformat }}</strong> star{{ channel.average_rating|pluralize }}</div>
                </li>
            </ul>
        </div>
    {% splitcolumns %}
         <div id="description">
        {% if shade_description %}
            <div id="summary">{{ channel.description|escape|striptags|truncatewords:73 }}</div>
            <div id="full">{{ channel.description|escape|striptags }}</div>
            <div id="reveal"><a href="#" onclick='$("#description #summary").hide();$("#description #reveal").hide();$("#description #full").show();$("#description #hide").show();'><span class="icon"></span>reveal all</a></div>
            <div id="hide"><a href="#" onclick='$("#description #summary").show();$("#description #reveal").show();$("#description #full").hide();$("#description #hide").hide();'><span class="icon"></span>hide</a></div>
        {% else %}
            {{ channel.description|escape }}
        {% endif %}
        </div>
{% comment %}            <div id=
            <div id="full">{{ channel.description|escape|striptags }}</div>
        </div>
        <div id="reveal"><a href="#" onclick='lowerDescription()'><span class="icon"></span>reveal all</a></div>
        <div id="hide"><a href="#" onclick='raiseDescription()'><span class="icon"></span>hide</a></div>{% endcomment %}
        {% comment %}
        <div id="comments">
            <h2>{% trans "User Reviews" %}</h2>
            <div id="review-link">(<a onclick="$('#comments #review').toggle();" href="#">{% trans "review this channel" %}</a>)</div>
            <div id="review">
                <form action="{{ channel.review_url }}" method="POST">
                    <textarea name="review">{{ user_review }}</textarea>
                    {% if user_review %}
                    <input type="submit" value="Edit">
                    {% else %}
                    <input type="submit" value="Submit">
                    {% endif %}
                </form>
            </div>
        </div>
        {% endcomment %}
        <div id="categories">
            <h3>{% trans "Categories" %}</h3>
            {% for cat in channel.categories %}
                {{ cat.link }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </div>
        {% if channel.tags %}
        <div id="tags">
            <h3>{% trans "Tags" %}</h3>
            {% for tag in channel.tags %}
                {{ tag.link }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </div>
        {% endif %}
        <div id="website">
            <h3>{% trans "Website" %}</h3>
            {{ channel.website_link }}
        </div>
        {% if show_extra_info %}
        <ul id="extra-info">
            <li><h3>{% trans "Owner Email" %}</h3>
            {{ channel.owner.email }}</li>
            <li><h3>{% trans "Moderation Status" %}</h3>
            {% blocktrans with channel.state_name as state %}
            Channel is {{ state }}
            {% endblocktrans %}
            {% if channel.last_moderated_by %}
            {% blocktrans with channel.last_moderated_by as mod %}
            (set by {{ mod }})
            {% endblocktrans %}
            {% if channel.featured_by %}
            {% blocktrans with channel.featured_by as feat %}
            Featured by {{ feat }}
            {% endblocktrans %}
            {% endif %}
            {% endif %}
        </li></ul>
        {% endif %}

        {% if user.is_moderator or show_edit_button %}
        <div class="clear"></div>
        <ul class="channel-actions">
        {% if user.is_moderator %}
            {% show_moderate_actions channel %}
        {% endif %}
        {% if show_edit_button %}
        <li class="channel-action">
        <form action="#" method="GET" onsubmit="return handleFormLink('{{ channel.get_edit_url }}');">
                <input type="submit" value="{% trans "Edit" %}">
            </form>
        </li>
        {% endif %}
        {% if featured_email_form %}
        <li class="channel-action">
            <h3>{% trans "Featured Channel Notification" %}</h3>
            <form method="POST" action="{{ channel.get_url }}">
                {% show_form featured_email_form %}
                <input type="hidden" name="action" value="send-featured-email">
                <ul class="form-inputs">
                    <li>
                        <input type="submit" value="Send">
                    </li>
                </ul>
            </form>
        </li>
        {% endif %}
        </ul>
        {% endif %}
   {% endtwocolumns %}
    {% twocolumns %}
        {% if items %}
            <div class="separator"></div>
            <h2 class="recent-videos-header">
                {% blocktrans %}
                Recent Videos
                <span class="sub-header">add this channel to watch</span>
                {% endblocktrans %}
                </h2>
            <ul id="items">
                {% for item in items %}
                    <li>
                    {% show_item item %}
                    {% if not forloop.last %}
                        <div class="separator"></div>
                    {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    {% splitcolumns %}

        {% if recommendations %}
        <div id="recommendations-pad"></div>
        <div id="recommendations">
            <div class="top"></div>
            <h2>{% trans "People who like this channel also like:" %}</h2>
        <table>
            <tr>
                <td>{% show_channel_in_recommendation recommendations.0 %}</td>
                <td>{%if recommendations.1 %}{% show_channel_in_recommendation recommendations.1 %}{% endif %}</td>
            </tr>
            <tr>
                <td>{% if recommendations.2 %}{% show_channel_in_recommendation recommendations.2 %}{% endif %}</td>
                <td>{% if recommendations.3 %}{% show_channel_in_recommendation recommendations.3 %}{% endif %}</td>
            </tr>
        </table>
        <div class="bottom"></div>
        </div>
        {% endif %}
    {% endtwocolumns %}
</div>
{% show_channel_notes notes channel %}
{% endblock %}
