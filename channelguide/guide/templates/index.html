{% extends "base.html" %}
{% load channels i18n %}
{% block head %}
<script type="text/javascript">
//<![CDATA[
var currentFeature = 0;
var featureWidth = 215;
var featureCount = 8;
var featureRotateSeconds = 10;
var featureRotateDirection = 1;
var featureTimeout = null;

function cancelFeaturedShuffle() {
    if (featureTimeout)
        clearTimeout(featureTimeout);
    featureTimeout = null;
}

function rotateFeatures() {
    currentFeature += featureRotateDirection;
    animateFeatured();
    if (featureTimeout)
        featureTimeout = setTimeout(rotateFeatures,
                                    featureRotateSeconds * 1000);
}

function featuredPrevious() {
    cancelFeaturedShuffle();
    currentFeature = currentFeature - 1;
    animateFeatured();
};
function featuredNext() {
    cancelFeaturedShuffle();
    currentFeature = currentFeature + 1;
    animateFeatured();
}

function animateFeatured() {
    ul = $("#featuredItemsCarousel ul");
    ul.animate({left: -((currentFeature + 3) * featureWidth)}, 500,
               function () {
                   if (currentFeature == featureCount) {
                       currentFeature = 0;
                       ul.css('left', -3 * featureWidth);
                   } else if (currentFeature == -3) {
                       currentFeature = featureCount - 3;
                       ul.css('left', -(featureCount * featureWidth));
                   }
               });
}

$(document).ready(function() {
    featureTimeout = setTimeout(rotateFeatures,
                                featureRotateSeconds * 1000);
    $("#button_next").click(featuredNext);
    $("#button_previous").click(featuredPrevious);
});
//]]>
</script>
{% endblock %}
{% block body %}
{% comment %}
<div id="guestEditorsPicks">
		<div class="page">
			<div id="guestEditorContent">
				<div class="preamble">
					<h2>Guest Editor's Picks</h2>
					<p>Hand-picked video by our lorem ipsum dolor sit amet, consectetuer adipiscing</p>
					<p><a href="#">Become a Guest Editor!</a></p>

					<p class="userInfo">
						<a href="#" class="tiny_thumbnail"><img src="{{ STATIC_BASE_URL}}images/editor_thumbnail.png" alt="" /></a>
						<span class="username"><a href="#">ElDuderino78</a></span>
						<span class="location">Worcester, MA</span>
					</p>
				</div><!--preamble-->
				<div class="view_more_featured_videos"><a href="#">View Miro Featured Videos</a></div>
			</div><!--guestEditorContent-->

			<!--Carousel-->
			<div id="featuredItemsCarousel" class="smallCarousel">
				<div id="button_previous"></div>
				<div id="innerContent">
					<ul>
						<li>
                                                  {% channel 0 featured %}
						</li>
						<li>
                                                  {% channel 0 featured %}
						</li>
					</ul>
				</div><!--innerContent-->
				<div id="button_next"></div>
			</div><!--featuredItemsCarousel-->
		</div><!--page-->
	</div><!--guestEditorsPicks-->
{% endcomment %}
	<div id="featured">
		<div class="page">

			<!--Carousel-->
			<div id="featuredItemsCarousel" class="largeCarousel">
				<div id="button_previous"></div>
				<div id="innerContent">
					<ul>
                                          {% for channel in featured|slice:"3:" %}
                                                <li>
                                                  {% channel channel featured %}
                                                </li>
                                          {% endfor %}
                                          {% for channel in featured %}
						<li>
                                                  {% channel channel featured %}
                                                </li>
                                          {% endfor %}
                                          {% for channel in featured|slice:":3" %}
                                                <li>
                                                  {% channel channel featured %}
                                                </li>
                                          {% endfor %}
					</ul>
				</div><!--innerContent-->
				<div id="button_next"></div>
			</div><!--featuredItemsCarousel-->
		</div><!--page-->
	</div><!--featured-->

	<div id="container">
		<div>
                        {% if feed %}
			<h3 class="title_bar"><span class="rss">{% trans "New Feed Videos" %}</span></h3>
			<ul class="videoFeed">
                          {% for channel in feed %}
				<li>
                                  {% channel channel small %}
				</li>
                          {% endfor %}
			</ul>
                        {% endif %}
                        {% if streaming %}
			<h3 class="title_bar"><span class="streaming">{% trans "New Streaming Videos" %}</span></h3>
			<ul class="videoFeed">
                          {% for channel in streaming %}
				<li>
                                  {% channel channel small %}
				</li>
                          {% endfor %}
			</ul>
                        {% endif %}
		</div>
                {% if recommended %}
		<div id="sideBar">
			<h3 class="widget_title_bar"><span class="favorite">{% trans "Recommended for you" %}</span></h3>
			<div class="widget">
				<ul class="recommended">
                                  {% for channel in recommended %}
					<li{% if forloop.last %} class="last_li"{% endif %}>
                                          {% channel channel buttons_bottom small %}
					</li>
                                  {% endfor %}
				</ul>
			</div><!--widget-->
			<div class="widget_close"><a href="{{ BASE_URL }}recommend/"><span>{% trans "View all" %}</span></a></div>
		</div>
                {% endif %}
	</div><!--container-->
{% endblock %}
