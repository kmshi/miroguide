<?xml version="1.0" encoding="utf-8"?>
{% extends 'base.html' %}
{% comment %}
Copyright (c) 2008 Participatory Culture Foundation
See LICENSE for details.
{% endcomment %}
{% load channels cg_helpers i18n %}

{% block head-extra %}
  <script src="{{ STATIC_BASE_URL }}js/feature_rotate.js"
          type="text/javascript"></script>
  <script src="{{ STATIC_BASE_URL }}js/genrebrowser.js"
          type="text/javascript"></script>
  <link rel="alternate" type="application/rss+xml" title="Featured Channels"
        href="https://www.miroguide.com/rss/featured"/>
  <link rel="alternate" type="application/rss+xml" title="New Channels"
        href="https://www.miroguide.com/rss/new" />
{% endblock %}

{% block onload-extra %}carouselOnLoad();{% endblock %}
{% block underwriting %}{% endblock %}

{% block content %}
  <div id="content" class="page">
    <div class="front-page">
      {% comment %}
        {# store stuff #}
        <div id="store">
          <a href="http://www.getmiro.com/store/">
            <img src="{{ STATIC_BASE_URL }}images/visit-the-store.png" />
          </a>
        </div>
        {# donate stuff #}
        <div class="shadow">
          <div id="donate">
            <img alt="heart" src="{{ STATIC_BASE_URL }}images/donate-heart.gif" />
            <h1>YOU ROCK!</h1>
            <img id="rainbow" src="{{ STATIC_BASE_URL }}images/rainbowoverlay.png" alt="Donation Thermometer at $50k with rainbow out the end" />
          </div>
        </div>
      {% endcomment %}

    <div id="featured">
      <div class="page">
        <!--Carousel-->
        <div id="featuredItemsCarousel" class="largeCarousel">
          <div id="button_previous">
            <span class="hidden">
              previous features
            </span>
          </div>
  	<div id="innerContent">
  	  <ul id="featured-list">
              {% for channel in featured_channels %}
                <li>{% show_channel_feature channel %}</li>
              {% endfor %}
              {% for channel in featured_channels_hidden %}
                <li class="column">
                  {% show_channel_feature channel %}
                </li>
              {% endfor %}
            </ul>
          </div>
  	<div id="button_next"></div>
        </div>
      </div>
    </div>

    {% comment %}
    <div id="survey">
      <!--/* OpenX Javascript Tag v2.4.7 */-->

      <script type='text/javascript'>
        <!--//<![CDATA[
     var m3_u = (location.protocol=='https:'?'https://www.miroguide.com/openx/www/delivery/ajs.php':'http://www.miroguide.com/openx/www/delivery/ajs.php');
     var m3_r = Math.floor(Math.random()*99999999999);
     if (!document.MAX_used) document.MAX_used = ',';
     document.write ("<scr"+"ipt type='text/javascript' src='"+m3_u);
     document.write ("?zoneid=1");
     document.write ('&amp;cb=' + m3_r);
     if (document.MAX_used != ',') document.write ("&amp;exclude=" + document.MAX_used);
     document.write ("&amp;loc=" + escape(window.location));
     if (document.referrer) document.write ("&amp;referer=" + escape(document.referrer));
     if (document.context) document.write ("&context=" + escape(document.context));
     if (document.mmm_fo) document.write ("&amp;mmm_fo=1");
     document.write ("'><\/scr"+"ipt>");
           //]]>-->
      </script>
      <noscript>
        <a href='http://www.miroguide.com/openx/www/delivery/ck.php?n=a2b24d67&amp;cb=INSERT_RANDOM_NUMBER_HERE'
           target='_blank'>
          <img src='http://www.miroguide.com/openx/www/delivery/avw.php?zoneid=1&amp;cb=INSERT_RANDOM_NUMBER_HERE&amp;n=a2b24d67'
               border='0' alt='' />
        </a>
      </noscript>
    </div>
    {% endcomment %}

    {% if language %}
    <a {% link language.get_url %}>
      <h1>{% trans "Channels in" %} {% trans language.name %}</h1>
    </a>
    {% endif %}

    <div id="container">
      <div id="contentSmall">
        <div class="detailsHead3">
          <h3 class="resultsCount">
            <span class="heading">{% trans "New Shows" %}</span>
          </h3>
          <div class="sortType">
            <a href="/new/">{% trans "All" %}</a>
          </div>
        </div>
        
        <ul class="newVideos">
          {% for channel in new_channels %}
            <li>{% show_channel_mini channel "episodes" %}</li>
          {% endfor %}
        </ul>
      </div>
      
      <div class="box_ad">
        <a href="#"><img src="{{ STATIC_BASE_URL }}images/ads/300x250.jpg" alt="" /></a>
        <span class="tag">
          {% trans "Please support our sponsors" %}
        </span>
        <span class="link"><a href="#">{% trans "Become One" %}</a></span>
      </div><!--box_ad-->
      
    </div><!--container-->
    
    <div id="channelEpisodes">
      <div class="page">
        <div class="pageContent">
          <div class="detailsHead">
            <h3 class="resultsCount">
              <a name="genres"></a><span class="heading">{% trans "Genres" %}</span>
            </h3>
            <div class="sortType">
              <a href="/genres/">{% trans "All" %}</a>
            </div>
          </div><!--detailsHead-->
          
          <a href="{{ category_peek.category.get_url }}" class="view_all_videos">
            {% blocktrans with category_peek.category.name as category %}
              View all of <strong>{{ category }}</strong>
            {% endblocktrans %}
          </a>
          
          <br clear="all" />

          <ul class="scrollNav">
            <li class="button_up"><a href="#">Up</a></li>
            <div>{# so we can limit the size of this part #}
            {% for category in categories %}
              <li><a {% ifequal category.id category_peek.category.id %}class="selected" {% endifequal %}onclick="return browser.browseGenre(this);" {% link category.get_url %}>{{ category.name }}</a></li>
              {% ifequal category.id category_peek.category.id %}
              <script type="text/javascript">
                  $("#channelEpisodes .scrollNav div").attr('scrollTop', 24 * {{ forloop.counter0 }});
              </script>
              {% endifequal %}
            {% endfor %}
            </div>
            <li class="button_down"><a href="#">Down</a></li>
            <script type="text/javascript">
                $('#channelEpisodes .scrollNav .button_up').hover(browser.scrollUp, browser.scrollStop);
                $('#channelEpisodes .scrollNav .button_down').hover(browser.scrollDown, browser.scrollStop);
            </script>
          </ul>
          
          <ul class="searchResults">
            {% for channel in category_peek.channels %}
              <li>{% include "guide/channel-in-category.html" %}</li>
            {% endfor %}
          </ul>
        </div>

        <div class="pageSideBar">
          <div id="sideBarSmall">
            <div class="detailsHead2">
              <h3 class="resultsCount">
                <span class="heading">
                  {% trans "Popular Shows" %}
                </span>
              </h3>
              <div class="sortType">
                <a href="/popular/">{% trans "All" %}</a>
              </div>
            </div>
            <div class="widget_small">
              <ul class="related">
                {% for channel in popular_channels %}
                  <li>
                    {% show_channel_mini channel "episodes" %}
                  </li>
                {% endfor %}
              </ul>
            </div><!--widget-->

          </div><!--sideBarSmall-->
        </div><!--pageSideBar-->
      </div><!--page-->
    </div><!--channelEpisodes-->

    <div class="horizontal_banner_ad">
      <a href="#"><img src="{{ STATIC_BASE_URL }}images/ads/728x90.jpg" alt="Ad" /></a>
    </div>

  </div>
{% endblock %}
